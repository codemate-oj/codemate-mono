{
  "openapi": "3.0.1",
  "info": { "title": "Codemate", "description": "", "version": "1.0.0" },
  "tags": [
    { "name": "验证码" },
    { "name": "登录" },
    { "name": "比赛" },
    { "name": "评测" },
    { "name": "首页" },
    { "name": "用户信息" },
    { "name": "实名" },
    { "name": "题目" },
    { "name": "注册" },
    { "name": "告示墙" }
  ],
  "paths": {
    "/login/sms-code": {
      "post": {
        "summary": "请求短信登录验证码",
        "deprecated": false,
        "description": "通过短信登陆，支持给定用户名/手机号登录，若两个字段同时传递则优先按用户名寻找用户。\n",
        "tags": ["验证码", "登录"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "uname": {
                    "type": "string",
                    "examples": ["user233"],
                    "description": "允许传入用户名或手机号",
                    "example": "18012345678"
                  },
                  "verifyToken": {
                    "description": "Recaptcha 等验证码返回的 token",
                    "example": "123456",
                    "type": "string"
                  }
                },
                "required": ["uname"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "success": { "type": "boolean" },
                    "tokenId": { "type": "string", "description": "在登陆时需要传递的 tokenId" }
                  },
                  "required": ["UserContext", "success", "tokenId"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/register/{tokenId}": {
      "post": {
        "summary": "验证码注册",
        "deprecated": false,
        "description": "通过手机验证码注册用户",
        "tags": [],
        "parameters": [
          { "name": "tokenId", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "verifyCode": {
                    "description": "发送的验证码，需要和token记录保持一致",
                    "example": "123456",
                    "type": "string"
                  },
                  "uname": {
                    "description": "用户名，不可包含中文和特殊字符，需要唯一",
                    "example": "user123",
                    "type": "string"
                  },
                  "password": {
                    "type": "string",
                    "format": "password",
                    "minLength": 6,
                    "maxLength": 255,
                    "description": "密码，最短6位",
                    "example": "pwd123"
                  },
                  "nationality": {
                    "type": "string",
                    "default": "zh",
                    "description": "国籍/地区代码，符合ISO标准，默认为中国（zh）",
                    "example": "zh"
                  },
                  "regionCode": {
                    "description": "国内地区代码，若为国外则用00000代替（不显示）",
                    "example": "11000",
                    "type": "string"
                  },
                  "userRole": {
                    "type": "integer",
                    "enum": [0, 1, 2, 3, 4],
                    "description": "用户角色枚举",
                    "example": "1"
                  },
                  "age": { "type": "integer", "format": "uint32", "description": "用户年龄", "example": "18" }
                },
                "required": ["verifyCode", "uname", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "success": { "type": "boolean" },
                    "code": { "type": "integer" },
                    "uid": { "type": "integer", "description": "注册的用户 uid" }
                  },
                  "required": ["UserContext", "success", "code", "uid"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/contest": {
      "get": {
        "summary": "比赛列表",
        "deprecated": false,
        "description": "分页的pageSize=20（数据库定义）",
        "tags": ["比赛"],
        "parameters": [
          {
            "name": "rule",
            "in": "query",
            "description": "比赛规则，直接对应rule字段，一般不使用该参数（留空）",
            "required": false,
            "example": "acm",
            "schema": {
              "type": "string",
              "enum": ["acm", "oi", "homework", "ioi", "ledo", "strictioi"],
              "x-apifox": {
                "enumDescriptions": { "acm": "", "oi": "", "homework": "", "ioi": "", "ledo": "", "strictioi": "" }
              }
            }
          },
          {
            "name": "group",
            "in": "query",
            "description": "只查看分配给某个小组的比赛，一般不使用该参数（留空）",
            "required": false,
            "example": "groupA",
            "schema": { "type": "string", "deprecated": true },
            "deprecated": true
          },
          {
            "name": "page",
            "in": "query",
            "description": "分页",
            "required": false,
            "example": "1",
            "schema": { "type": "integer" }
          },
          {
            "name": "tags",
            "in": "query",
            "description": "逗号分隔数组，查询比赛标签",
            "required": false,
            "example": "a,b,c",
            "schema": { "type": "string" }
          },
          {
            "name": "category",
            "in": "query",
            "description": "查询比赛状态，对应左侧筛选条件（留空则查询全部）",
            "required": false,
            "example": "incoming",
            "schema": {
              "type": "string",
              "enum": ["incoming", "ready", "ongoing", "done"],
              "x-apifox": {
                "enumDescriptions": { "incoming": "预告中", "ready": "可报名", "ongoing": "进行中", "done": "已结束" }
              }
            }
          },
          {
            "name": "q",
            "in": "query",
            "description": "模糊搜索值（开发中）",
            "required": false,
            "example": "测试比赛",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "page": { "type": "integer", "title": "分页序号" },
                    "tpcount": { "type": "integer", "title": "页面总数" },
                    "qs": { "type": "string", "title": "查询条件" },
                    "rule": {
                      "type": "string",
                      "deprecated": true,
                      "description": "rule字段包含在了qs中，已废弃",
                      "title": "筛选规则"
                    },
                    "tdocs": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/ContestBase" },
                      "title": "比赛列表"
                    },
                    "tsdict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": { "type": "object", "properties": {} }
                    },
                    "groups": {
                      "type": "string",
                      "title": "用户可用小组",
                      "deprecated": true,
                      "description": "不会用到"
                    },
                    "group": {
                      "type": "string",
                      "title": "筛选组名",
                      "description": "group包含在了qs中，已废弃",
                      "deprecated": true
                    },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": [
                    "UserContext",
                    "UiContext",
                    "page",
                    "tpcount",
                    "qs",
                    "rule",
                    "tdocs",
                    "tsdict",
                    "groups",
                    "group"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/record": {
      "get": {
        "summary": "获取评测记录列表",
        "deprecated": false,
        "description": "",
        "tags": ["评测"],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "默认为1",
            "required": false,
            "example": "1",
            "schema": { "type": "integer", "format": "uint32", "default": 1 }
          },
          {
            "name": "pid",
            "in": "query",
            "description": "可以是pid或docId",
            "required": false,
            "example": "P0001",
            "schema": { "type": "string", "examples": ["1"] }
          },
          {
            "name": "tid",
            "in": "query",
            "description": "比赛的ObjectID",
            "required": false,
            "schema": { "type": "string" }
          },
          {
            "name": "uidOrName",
            "in": "query",
            "description": "",
            "required": false,
            "example": "",
            "schema": { "type": "string" }
          },
          {
            "name": "lang",
            "in": "query",
            "description": "评测语言",
            "required": false,
            "example": "cc.cc14o2",
            "schema": {
              "type": "string",
              "enum": ["cc.cc14o2", "py.py3", "scratch"],
              "x-apifox": { "enumDescriptions": { "cc.cc14o2": "C++", "py.py3": "Python", "scratch": "Scratch" } }
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "评测状态",
            "required": false,
            "example": "1",
            "schema": {
              "type": "integer",
              "format": "uint32",
              "enum": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 30, 31, 32, 33],
              "x-apifox": {
                "enumDescriptions": {
                  "0": "STATUS_WAITING",
                  "1": "STATUS_ACCEPTED",
                  "2": "STATUS_WRONG_ANSWER",
                  "3": "STATUS_TIME_LIMIT_EXCEEDED",
                  "4": "STATUS_MEMORY_LIMIT_EXCEEDED",
                  "5": "STATUS_OUTPUT_LIMIT_EXCEEDED",
                  "6": "STATUS_RUNTIME_ERROR",
                  "7": "STATUS_COMPILE_ERROR",
                  "8": "STATUS_SYSTEM_ERROR",
                  "9": "STATUS_CANCELED",
                  "10": "STATUS_ETC",
                  "11": "STATUS_HACKED",
                  "20": "STATUS_JUDGING",
                  "21": "STATUS_COMPILING",
                  "22": "STATUS_FETCHED",
                  "30": "STATUS_IGNORED",
                  "31": "STATUS_FORMAT_ERROR",
                  "32": "STATUS_HACK_SUCCESSFUL",
                  "33": "STATUS_HACK_UNSUCCESSFUL"
                }
              }
            }
          },
          {
            "name": "fullStatus",
            "in": "query",
            "description": "是否获取评测记录全部成员（默认为简略状态）",
            "required": false,
            "example": "true",
            "schema": { "type": "boolean", "default": false }
          },
          {
            "name": "all",
            "in": "query",
            "description": "是否获取全部记录（需要对应权限）",
            "required": false,
            "example": "true",
            "schema": { "type": "boolean", "default": false }
          },
          {
            "name": "allDomain",
            "in": "query",
            "description": "是否获取全部域的记录（需要对应权限）",
            "required": false,
            "example": "true",
            "schema": { "type": "boolean", "default": false }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "page": { "type": "number", "title": "当前页码" },
                    "rdocs": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/Record" },
                      "title": "所有评测记录"
                    },
                    "tdoc": { "$ref": "#/components/schemas/Contest", "title": "查询的比赛信息" },
                    "pdict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": { "type": "object", "properties": {} }
                    },
                    "udict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": {
                        "type": "object",
                        "properties": { "01HY63GX1S0DYHBD11ZQFC3F1E": { "type": "string" } },
                        "required": ["01HY63GX1S0DYHBD11ZQFC3F1E"]
                      }
                    },
                    "all": { "type": "boolean", "description": "对应上面的筛选条件" },
                    "allDomain": { "type": "boolean", "description": "对应上面的筛选条件" },
                    "filterPid": { "type": "string", "description": "对应上面的筛选条件" },
                    "filterTid": { "type": "string", "description": "对应上面的筛选条件" },
                    "filterUidOrName": { "type": "string", "description": "对应上面的筛选条件" },
                    "filterLang": { "type": "string", "description": "对应上面的筛选条件" },
                    "filterStatus": { "type": "string", "description": "对应上面的筛选条件" }
                  },
                  "required": [
                    "UserContext",
                    "UiContext",
                    "page",
                    "rdocs",
                    "tdoc",
                    "pdict",
                    "udict",
                    "all",
                    "allDomain",
                    "filterPid",
                    "filterTid",
                    "filterUidOrName",
                    "filterLang",
                    "filterStatus"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/tagsFilter/modify": {
      "post": {
        "summary": "修改标签筛选器",
        "deprecated": false,
        "description": "修改标签筛选器",
        "tags": [],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": { "addFilter": { "type": "string" }, "delFilter": { "type": "string" } }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/p": {
      "get": {
        "summary": "首页题目筛选",
        "deprecated": false,
        "description": "支持多条件并列筛选，默认留空的情况下直接读取题库题目；\n由于 `config` 是yaml文本实现（hydro的狗屎设计），导致没法在filter时直接使用配置，只能在读取完成分页后再筛选，因此可能导致**每个分页元素数不等**，`lang`和`objective`这两个定义在config中的选项会受到影响，请注意",
        "tags": ["首页"],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "默认值为1，分页参数",
            "required": false,
            "example": "1",
            "schema": { "type": "integer" }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "默认值为system_setting.pagination.problem",
            "required": false,
            "example": "15",
            "schema": { "type": "integer" }
          },
          {
            "name": "tags",
            "in": "query",
            "description": "逗号分隔数组，不需要括号包裹，请URLEncode",
            "required": false,
            "example": ["贪心算法,动态规划"],
            "schema": { "type": "array", "items": { "type": "string" } }
          },
          {
            "name": "lang",
            "in": "query",
            "description": "指定可用于提交题目的语言【WARN：使用该选项可能导致每个分页元素数不等】",
            "required": false,
            "example": "scratch",
            "schema": { "type": "string" }
          },
          {
            "name": "objective",
            "in": "query",
            "description": "默认为false，为true时只选择客观题【WARN：使用该选项可能导致每个分页元素数不等】",
            "required": false,
            "example": "true",
            "schema": { "type": "boolean", "default": false }
          },
          {
            "name": "q",
            "in": "query",
            "description": "用于模糊搜索文本，可以与上面的条件一起使用（支持使用qs查询，但建议使用上面的接口）",
            "required": false,
            "example": "图形化",
            "schema": { "type": "string" }
          },
          {
            "name": "source",
            "in": "query",
            "description": "指定从某个系统题单中查询符合上述条件的题目",
            "required": false,
            "example": "66200c489cd74d3e4c931302",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "page": { "type": "integer", "title": "当前页" },
                    "pcount": { "type": "integer", "title": "总页数" },
                    "ppcount": { "type": "integer", "title": "总题目数", "description": "当前条件下的总题目数" },
                    "pcountRelation": {
                      "type": "string",
                      "enum": ["eq", "gte"],
                      "title": "查找结果关系",
                      "description": "默认为eq即可，可忽略"
                    },
                    "pdocs": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "docType": {
                            "type": "number",
                            "const": 10,
                            "title": "类型",
                            "description": "题目docType=10"
                          },
                          "docId": { "type": "number", "description": "题目真实ID是数字" },
                          "pid": {
                            "type": "string",
                            "title": "PID",
                            "description": "题目外显ID可以是pid，二者都可以寻址到题目"
                          },
                          "title": { "type": "string" },
                          "nSubmit": { "type": "number" },
                          "nAccept": { "type": "number" },
                          "tag": { "type": "array", "items": { "type": "string" } },
                          "hidden": { "type": "boolean" },
                          "stats": { "type": "string" },
                          "difficulty": { "type": "number" },
                          "config": {
                            "oneOf": [{ "type": "string" }, { "$ref": "#/components/schemas/ProblemConfig" }]
                          }
                        },
                        "required": ["docType", "docId", "pid", "title", "nSubmit", "nAccept", "tag", "config"]
                      },
                      "title": "题目"
                    },
                    "psdict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": { "type": "object", "properties": {} },
                      "title": "题目用户状态字典"
                    },
                    "qs": { "type": "string", "title": "查询入参" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": [
                    "UserContext",
                    "UiContext",
                    "page",
                    "pcount",
                    "ppcount",
                    "pcountRelation",
                    "pdocs",
                    "qs",
                    "psdict"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      },
      "post": {
        "summary": "取消收藏题目",
        "deprecated": false,
        "description": "",
        "tags": ["题目"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "operation": {
                    "type": "string",
                    "const": "unstar",
                    "description": "操作名，Hydro特有的post魔法",
                    "example": "unstar"
                  },
                  "pid": { "type": "integer", "format": "uint32", "description": "题目ID", "example": "1" }
                },
                "required": ["operation"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/domain/group/code": {
      "get": {
        "summary": "导出所有激活码数据",
        "deprecated": false,
        "description": "需要用户有**编辑域**的权限",
        "tags": [],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "groups": { "type": "array", "items": { "$ref": "#/components/schemas/Group" } },
                    "tokens": { "type": "array", "items": { "$ref": "#/components/schemas/ActivationToken" } }
                  },
                  "required": ["UserContext", "UiContext", "groups", "tokens"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/captcha/test": {
      "get": {
        "summary": "验证码（测试）",
        "deprecated": false,
        "description": "**仅在 debug 模式中可用**\n\n测试验证码.",
        "tags": ["验证码"],
        "parameters": [
          {
            "name": "ticket",
            "in": "query",
            "description": "前端验证返回的 ticket",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "name": "randStr",
            "in": "query",
            "description": "前端验证返回的随机字符串",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "success": { "type": "boolean", "description": "验证是否成功" }
                  },
                  "required": ["UserContext", "UiContext", "success"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/user/verify": {
      "post": {
        "summary": "上传实名信息",
        "deprecated": false,
        "description": "上传实名信息（身份证号和姓名），在服务端调用第三方接口验证。",
        "tags": ["比赛", "用户信息", "实名"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "idNumber": { "example": "110101200312133798", "type": "string" },
                  "realName": { "example": "张三", "type": "string" }
                },
                "required": ["idNumber", "realName"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "success": { "type": "boolean" },
                    "code": { "type": "integer" },
                    "idNumber": { "type": "string" },
                    "realName": { "type": "string" }
                  },
                  "required": ["UserContext", "UiContext", "success", "code", "idNumber", "realName"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      },
      "get": {
        "summary": "获取实名认证信息",
        "deprecated": false,
        "description": "获取实名认证信息",
        "tags": ["比赛", "用户信息", "实名"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "idNumber": { "type": "string", "title": "身份证号" },
                    "realName": { "type": "string", "title": "真实姓名" },
                    "verified": { "type": "boolean", "title": "是否通过验证", "description": "是否通过了API校验" }
                  },
                  "required": ["UserContext", "UiContext", "idNumber", "realName", "verified"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/p-list": {
      "get": {
        "summary": "获取所有系统题单",
        "deprecated": false,
        "description": "以树状结构获取所有系统题单，用于首页的筛选树",
        "tags": ["首页"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "roots": { "type": "array", "items": { "$ref": "#/components/schemas/SystemProblemList" } }
                  },
                  "required": ["UserContext", "UiContext", "roots"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/logout": {
      "post": {
        "summary": "登出",
        "deprecated": false,
        "description": "登出",
        "tags": ["登录"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "x-200:Redirect": {
            "description": "Redirect",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "url": { "type": "string", "title": "重定向的URL" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["url", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/register/sms-code": {
      "post": {
        "summary": "请求手机验证码",
        "deprecated": false,
        "description": "获取手机验证码\n\n\n\n",
        "tags": ["验证码", "注册"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "phoneNumber": { "example": "12345678900", "type": "string" },
                  "verifyToken": {
                    "description": "Recaptcha 等验证码返回的 token",
                    "example": "123456",
                    "type": "string"
                  }
                },
                "required": ["phoneNumber"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "success": { "type": "boolean" },
                    "code": { "type": "integer" },
                    "tokenId": { "type": "string" }
                  },
                  "required": ["success", "code", "tokenId", "UserContext"]
                },
                "examples": {
                  "1": { "summary": "成功示例", "value": { "success": true, "code": 0, "tokenId": "abc123" } },
                  "2": { "summary": "异常示例", "value": { "success": false, "code": -1 } }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/p-list/{tid}": {
      "get": {
        "summary": "获取题单详情",
        "deprecated": false,
        "description": "获取题单所有信息，包含内部所有题目、题目字典和是否有权限。",
        "tags": ["首页"],
        "parameters": [
          { "name": "tid", "in": "path", "description": "题单docId", "required": true, "schema": { "type": "string" } },
          {
            "name": "page",
            "in": "query",
            "description": "可选",
            "required": false,
            "example": "1",
            "schema": { "type": "integer" }
          },
          {
            "name": "pageSize",
            "in": "query",
            "description": "可选",
            "required": false,
            "example": "15",
            "schema": { "type": "integer" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": { "application/x-www-form-urlencoded": { "schema": { "type": "object", "properties": {} } } }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "tdoc": { "$ref": "#/components/schemas/SystemProblemList" },
                    "pdict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": { "type": "object", "properties": {} },
                      "definitions": { "ProblemDoc": { "type": "object" } },
                      "description": "题目字典，用于pid查询对应的详情"
                    },
                    "hasPermission": { "type": "boolean", "description": "是否有该题单的权限" },
                    "page": { "type": "integer" },
                    "pageSize": { "type": "integer" },
                    "pageCount": { "type": "integer" }
                  },
                  "required": [
                    "UserContext",
                    "UiContext",
                    "tdoc",
                    "pdict",
                    "hasPermission",
                    "page",
                    "pageSize",
                    "pageCount"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      },
      "post": {
        "summary": "获取题单中上一题",
        "deprecated": false,
        "description": "获取题单中的上一题",
        "tags": ["题目"],
        "parameters": [
          { "name": "tid", "in": "path", "description": "题单docId", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "operation": {
                    "type": "string",
                    "const": "prev",
                    "description": "操作名，Hydro特有的post魔法",
                    "example": "prev"
                  },
                  "curPid": { "type": "string", "description": "当前PID", "example": "1" }
                },
                "required": ["operation", "curPid"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "pid": { "type": "integer", "description": "目标题目id" },
                    "access": { "type": "boolean", "description": "是否有对应题目权限" }
                  },
                  "required": ["UserContext", "UiContext", "pid", "access"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/contest/{tid}": {
      "get": {
        "summary": "比赛详情",
        "deprecated": false,
        "description": "",
        "tags": ["比赛"],
        "parameters": [
          {
            "name": "tid",
            "in": "path",
            "description": "比赛ID",
            "required": true,
            "example": "660fb4f221e13d71de96129a",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "tdoc": { "$ref": "#/components/schemas/Contest", "title": "查询的比赛信息" },
                    "tsdoc": {
                      "title": "用户状态",
                      "type": "object",
                      "properties": {
                        "_id": { "type": "string", "title": "ObjectID" },
                        "docId": { "type": "string", "description": "关联的DocID" },
                        "docType": { "type": "number", "description": "关联的DocType" },
                        "domainId": { "type": "string", "title": "域ID" },
                        "uid": { "type": "number", "title": "用户ID" },
                        "attend": { "type": "integer", "title": "是否参加", "enum": [1, 0], "default": null },
                        "startAt": { "type": "string", "title": "参加时间", "format": "date-time" }
                      },
                      "required": ["_id", "docId", "docType", "domainId", "uid"]
                    },
                    "udict": {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": { "type": "object", "properties": {} },
                      "title": "用户字典",
                      "description": "用于owner的显示"
                    },
                    "files": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/FileInfo" },
                      "title": "比赛相关文件"
                    },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["UserContext", "UiContext", "tdoc", "tsdoc", "udict", "files"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      },
      "post": {
        "summary": "报名比赛",
        "deprecated": false,
        "description": "**自带实名认证**，无需手动请求",
        "tags": ["比赛"],
        "parameters": [
          { "name": "tid", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "operation": {
                    "type": "string",
                    "const": "attend",
                    "description": "操作名，Hydro特有的post魔法",
                    "example": "attend"
                  },
                  "code": { "description": "比赛邀请码，可选", "example": "abcde", "type": "string" }
                },
                "required": ["operation"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "x-200:Redirect": {
            "description": "Redirect",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "url": { "type": "string", "title": "重定向的URL" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["url", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/login/{tokenId}": {
      "post": {
        "summary": "短信验证码登录",
        "deprecated": false,
        "description": "",
        "tags": ["验证码", "登录"],
        "parameters": [
          { "name": "tokenId", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "verifyCode": { "description": "短信验证码", "example": "123456", "type": "string" },
                  "rememberme": {
                    "type": "boolean",
                    "default": false,
                    "description": "长期记忆session",
                    "example": "true"
                  },
                  "redirect": { "description": "登陆后跳转url", "example": "/", "type": "string" }
                },
                "required": ["verifyCode"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                },
                "examples": { "1": { "summary": "成功示例", "value": { "redirect": "/" } } }
              }
            }
          },
          "x-200:Redirect": {
            "description": "Redirect",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "url": { "type": "string", "title": "重定向的URL" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["url", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/priv": {
      "post": {
        "summary": "激活指定组权限",
        "deprecated": false,
        "description": "使用激活码激活指定组权限",
        "tags": ["首页"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "operation": {
                    "type": "string",
                    "const": "activate",
                    "description": "操作名，Hydro特有的post魔法",
                    "example": "activate"
                  },
                  "code": {
                    "type": "string",
                    "minLength": 6,
                    "maxLength": 6,
                    "description": "激活码（6位）",
                    "example": "aaaaa"
                  },
                  "uid": { "type": "integer", "description": "UID（留空则使用session值）", "example": "1" }
                },
                "required": ["operation", "code"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "success": { "type": "boolean" },
                    "group": { "type": "string", "title": "组名", "description": "激活的小组名称" }
                  },
                  "required": ["UserContext", "UiContext", "success", "group"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/list": {
      "get": {
        "summary": "查询公告列表",
        "deprecated": false,
        "description": "",
        "tags": ["告示墙"],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "分页，为空时不分页",
            "required": false,
            "example": "1",
            "schema": { "type": "integer", "minimum": 0 }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "分页大小，默认为server.bulletin.limit",
            "required": false,
            "example": "15",
            "schema": { "type": "integer", "default": 15 }
          },
          {
            "name": "tags",
            "in": "query",
            "description": "筛选的标签，为空时展示全部",
            "required": false,
            "example": "a,b,c",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "bdocs": { "type": "array", "items": { "$ref": "#/components/schemas/BulletinDoc" } },
                    "bdocsPage": { "type": "number", "description": "按当前limit的page数量" }
                  },
                  "required": ["UserContext", "UiContext", "bdocs", "bdocsPage"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/register/email-code": {
      "post": {
        "summary": "请求邮箱验证码",
        "deprecated": false,
        "description": "获取邮箱验证码",
        "tags": ["验证码", "注册"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "mail": { "example": "{% mock 'email' %}", "type": "string" },
                  "verifyToken": {
                    "description": "Recaptcha 等验证码返回的 token",
                    "example": "123456",
                    "type": "string"
                  }
                },
                "required": ["mail"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "success": { "type": "boolean" },
                    "code": { "type": "integer" },
                    "tokenId": { "type": "string" }
                  },
                  "required": ["success", "code", "tokenId", "UserContext"]
                },
                "examples": {
                  "1": { "summary": "成功示例", "value": { "success": true, "code": 0, "tokenId": "abc123" } }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/p/{pid}": {
      "get": {
        "summary": "获取题目详情",
        "deprecated": false,
        "description": "",
        "tags": ["题目"],
        "parameters": [
          {
            "name": "pid",
            "in": "path",
            "description": "题目ID",
            "required": true,
            "example": "1",
            "schema": { "type": "string" }
          },
          {
            "name": "tid",
            "in": "query",
            "description": "比赛ID（如果有的话）",
            "required": false,
            "example": "abcedefg",
            "schema": { "type": "string" }
          },
          {
            "name": "pjax",
            "in": "query",
            "description": "pjax请求（已废弃）",
            "required": false,
            "example": "false",
            "schema": { "type": "boolean", "deprecated": true },
            "deprecated": true
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "pdoc": {
                      "title": "题目信息",
                      "type": "object",
                      "properties": {
                        "docType": { "type": "number", "const": 10, "title": "类型", "description": "题目docType=10" },
                        "docId": { "type": "number", "description": "题目真实ID是数字" },
                        "pid": {
                          "type": "string",
                          "title": "PID",
                          "description": "题目外显ID可以是pid，二者都可以寻址到题目"
                        },
                        "title": { "type": "string" },
                        "content": { "type": "string" },
                        "tag": { "type": "array", "items": { "type": "string" } },
                        "data": {
                          "type": "array",
                          "items": { "$ref": "#/components/schemas/FileInfo" },
                          "description": "题目数据（如输入、输出等）",
                          "title": "数据文件"
                        },
                        "additional_file": {
                          "type": "array",
                          "items": { "$ref": "#/components/schemas/FileInfo" },
                          "title": "其他文件"
                        },
                        "hidden": { "type": "boolean" },
                        "html": { "type": "boolean", "description": "是否为HTML格式" },
                        "sort": { "type": "string", "description": "题目用于排序的字段" },
                        "reference": {
                          "type": "object",
                          "properties": { "domainId": { "type": "string" }, "pid": { "type": "number" } },
                          "required": ["domainId", "pid"]
                        },
                        "assign": { "type": "array", "items": { "type": "string" } },
                        "config": { "oneOf": [{ "type": "string" }, { "$ref": "#/components/schemas/ProblemConfig" }] }
                      },
                      "required": [
                        "docType",
                        "docId",
                        "pid",
                        "title",
                        "content",
                        "tag",
                        "data",
                        "additional_file",
                        "config"
                      ]
                    },
                    "udoc": { "$ref": "#/components/schemas/User" },
                    "psdoc": {
                      "anyOf": [{ "$ref": "#/components/schemas/ProblemStatus" }, { "type": "null" }],
                      "title": "题目状态",
                      "description": "无tid时为null"
                    },
                    "title": { "type": "string", "title": "题目标题" },
                    "solutionCount": { "type": "integer", "format": "uint32", "title": "总题解数" },
                    "discussionCount": { "type": "integer", "format": "uint32", "title": "总讨论数" },
                    "tdoc": {
                      "title": "比赛信息",
                      "description": "仅在存在tid时才会有值",
                      "type": "object",
                      "properties": {
                        "_id": { "type": "string", "description": "ObjectID" },
                        "docId": { "type": "string", "description": "ObjectID" },
                        "docType": {
                          "type": "integer",
                          "enum": [30, 31, 32, 40],
                          "format": "uint32",
                          "title": "类型",
                          "description": "30=比赛 32=系统题单"
                        },
                        "beginAt": {
                          "type": "string",
                          "format": "date-time",
                          "title": "开始日期",
                          "description": "比赛/作业的开放日期（题单不受此影响）"
                        },
                        "endAt": { "type": "string", "format": "date-time", "title": "结束日期" },
                        "attend": { "type": "number", "title": "参加人数" },
                        "title": { "type": "string", "title": "标题" },
                        "content": { "type": "string", "title": "说明内容" },
                        "rule": {
                          "type": "string",
                          "enum": ["acm", "oi", "homework", "ioi", "ledo", "strictioi"],
                          "examples": ["homework"],
                          "title": "规则",
                          "description": "比赛规则（赛制），homework为特殊规则"
                        },
                        "pids": { "type": "array", "items": { "type": "number" }, "title": "题目" },
                        "rated": { "type": "boolean", "title": "是否排名" },
                        "_code": { "type": "string" },
                        "assign": {
                          "type": "array",
                          "items": { "type": "string", "description": "小组名" },
                          "title": "分配给",
                          "description": "若只分配给特定小组，则只有特定组有权限访问（与权限组结合）"
                        },
                        "files": { "type": "array", "items": { "$ref": "#/components/schemas/FileInfo" } },
                        "allowViewCode": { "type": "boolean" },
                        "lockAt": {
                          "type": "string",
                          "format": "date-time",
                          "description": "仅用于比赛",
                          "title": "锁定日期"
                        },
                        "unlocked": { "type": "boolean", "title": "是否解封", "description": "仅用于比赛" },
                        "autoHide": {
                          "type": "boolean",
                          "title": "自动隐藏",
                          "description": "不在日期内自动隐藏，仅用于比赛（schedule实现）"
                        },
                        "balloon": {
                          "type": "object",
                          "additionalProperties": { "type": "string" },
                          "properties": {},
                          "description": "仅用于比赛"
                        },
                        "score": {
                          "type": "object",
                          "additionalProperties": { "type": "number" },
                          "properties": {},
                          "title": "参与者得分",
                          "description": "仅用于比赛"
                        },
                        "duration": { "type": "number", "title": "比赛时长", "description": "单位为小时，仅用于比赛" }
                      },
                      "required": [
                        "_id",
                        "docId",
                        "docType",
                        "beginAt",
                        "endAt",
                        "attend",
                        "title",
                        "content",
                        "rule",
                        "pids",
                        "duration"
                      ]
                    },
                    "owner_udoc": {
                      "title": "比赛所有者信息",
                      "description": "仅在存在tid时才会有值（在所有者请求时会返回null）",
                      "anyOf": [{ "$ref": "#/components/schemas/User" }, { "type": "null" }]
                    },
                    "rdoc": { "$ref": "#/components/schemas/Record" },
                    "ctdocs": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/Contest", "title": "查询的比赛信息" },
                      "title": "相关比赛"
                    },
                    "htdocs": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/Contest", "title": "查询的比赛信息" },
                      "title": "相关作业"
                    }
                  },
                  "required": [
                    "UserContext",
                    "UiContext",
                    "pdoc",
                    "udoc",
                    "psdoc",
                    "title",
                    "solutionCount",
                    "discussionCount",
                    "owner_udoc",
                    "rdoc",
                    "ctdocs",
                    "htdocs"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/tags": {
      "get": {
        "summary": "获取可用公告标签",
        "deprecated": false,
        "description": "获取告示栏上方的标签列表",
        "tags": ["告示墙"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "bulletinTags": { "type": "array", "items": { "type": "string" } }
                  },
                  "required": ["UserContext", "UiContext", "bulletinTags"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/login": {
      "post": {
        "summary": "用户名&密码登录",
        "deprecated": false,
        "description": "使用用户名和密码登录",
        "tags": ["首页", "登录"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "uname": { "example": "{{admin_uname}}", "type": "string" },
                  "password": { "example": "{{admin_pwd}}", "type": "string" }
                },
                "required": ["uname", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "x-200:Redirect": {
            "description": "Redirect",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "url": { "type": "string", "title": "重定向的URL" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["url", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/p/{pid}/submit": {
      "post": {
        "summary": "提交评测",
        "deprecated": false,
        "description": "",
        "tags": ["题目", "评测"],
        "parameters": [
          { "name": "pid", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "tid",
            "in": "query",
            "description": "比赛ObjectID",
            "required": false,
            "example": "abcd",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "lang": {
                    "type": "string",
                    "enum": ["cc.cc14o2", "py.py3", "scratch", "_"],
                    "description": "提交语言",
                    "example": "py.py3"
                  },
                  "code": { "description": "代码内容", "example": "print('Hello World')", "type": "string" },
                  "pretest": {
                    "type": "boolean",
                    "description": "是否为比赛统一评测，若为统一评测则返回tid，否则返回rid",
                    "example": "true"
                  },
                  "input": { "type": "string" },
                  "tid": { "description": "比赛ID", "type": "string" }
                },
                "required": ["lang"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "url": { "type": "string", "title": "跳转URL" },
                    "rid": { "type": "string", "title": "评测记录ID", "description": "非集中评测模式返回rid" },
                    "tid": { "type": "string", "description": "集中评测模式返回tid", "title": "比赛ID" }
                  },
                  "required": ["UserContext", "UiContext", "url"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/detail/{bid}": {
      "get": {
        "summary": "获取公告详情",
        "deprecated": false,
        "description": "",
        "tags": ["告示墙"],
        "parameters": [
          {
            "name": "bid",
            "in": "path",
            "description": "BulletinID",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "bdoc": { "$ref": "#/components/schemas/BulletinDoc" }
                  },
                  "required": ["UserContext", "UiContext", "bdoc"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/contest/{tid}/problems": {
      "get": {
        "summary": "获取比赛题单",
        "deprecated": false,
        "description": "未加入、未开始的比赛会抛出错误；首次访问会被视为参加了比赛，会添加`startAt`记录",
        "tags": ["比赛"],
        "parameters": [
          { "name": "tid", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/domain/group/{gid}/code": {
      "get": {
        "summary": "获取小组所有的激活码",
        "deprecated": false,
        "description": "【要求域编辑权限】在域管理面板中编辑小组时，可以通过该接口获取特定组的激活码。",
        "tags": [],
        "parameters": [
          {
            "name": "gid",
            "in": "path",
            "description": "",
            "required": true,
            "example": "660f57076cdd0d8ef6fa4349",
            "schema": { "type": "string" }
          },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "group": { "$ref": "#/components/schemas/Group" },
                    "tokens": { "type": "array", "items": { "type": "string" }, "description": "所有激活码" }
                  },
                  "required": ["UserContext", "UiContext", "group", "tokens"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      },
      "post": {
        "summary": "新增激活码",
        "deprecated": false,
        "description": "给指定小组生成指定数量的激活码",
        "tags": [],
        "parameters": [
          { "name": "gid", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "expireAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "激活码过期时间",
                    "example": "2024-04-23T12:49:00.308Z"
                  },
                  "times": {
                    "type": "integer",
                    "default": 1,
                    "minimum": 0,
                    "exclusiveMinimum": true,
                    "description": "允许使用次数（默认为1）",
                    "example": "1"
                  },
                  "owner": { "description": "激活码所属机构名", "example": "admin", "type": "string" },
                  "genNum": {
                    "type": "integer",
                    "default": 1,
                    "minimum": 1,
                    "description": "生成数量，默认为1",
                    "example": "1"
                  }
                },
                "required": ["expireAt"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" }
                  },
                  "required": ["UserContext", "UiContext"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "x-200:Redirect": {
            "description": "Redirect",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "url": { "type": "string", "title": "重定向的URL" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "success": { "type": "boolean" },
                    "data": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/ActivationToken" },
                      "description": "生成的激活码"
                    }
                  },
                  "required": ["url", "UiContext", "UserContext", "success", "data"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/create": {
      "post": {
        "summary": "创建新公告",
        "deprecated": false,
        "description": "创建一个新公告",
        "tags": ["告示墙"],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "content": { "description": "In markdown", "type": "string" },
                  "tags": { "description": "标签，用英文逗号 \",\" 分割", "type": "string" }
                },
                "required": ["title", "content", "tags"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "docId": { "type": "string", "description": "新添加的公告 ID" }
                  },
                  "required": ["UserContext", "UiContext", "docId"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/tags/edit": {
      "post": {
        "summary": "修改公告标签",
        "deprecated": false,
        "description": "修改公告标签 (覆盖)",
        "tags": [],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": { "tags": { "description": "用英文半角逗号分割", "example": "a,b,c", "type": "string" } },
                "required": ["tags"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "success": { "type": "boolean" },
                    "bulletinTags": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "修改后的tags(应该与你传入的相同)"
                    }
                  },
                  "required": ["UserContext", "UiContext", "bulletinTags", "success"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/bulletin/delete/{bid}": {
      "post": {
        "summary": "删除公告",
        "deprecated": false,
        "description": "",
        "tags": [],
        "parameters": [
          { "name": "bid", "in": "path", "description": "", "required": true, "schema": { "type": "string" } },
          {
            "name": "Accept",
            "in": "header",
            "description": "",
            "example": "application/json",
            "schema": { "type": "string", "default": "application/json" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserContext": { "$ref": "#/components/schemas/UserContext" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "success": { "type": "boolean" }
                  },
                  "required": ["UserContext", "UiContext", "success"]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "title": "",
                  "type": "object",
                  "properties": {
                    "error": { "$ref": "#/components/schemas/Error", "description": "错误信息" },
                    "UiContext": { "$ref": "#/components/schemas/UiContext" },
                    "UserContext": { "$ref": "#/components/schemas/UserContext" }
                  },
                  "required": ["error", "UiContext", "UserContext"]
                }
              }
            }
          }
        },
        "security": []
      }
    }
  },
  "components": {
    "schemas": {
      "BulletinDoc": {
        "type": "object",
        "properties": {
          "title": { "type": "string" },
          "tags": { "type": "array", "items": { "type": "string" }, "title": "标签" },
          "content": { "type": "string", "title": "内容", "description": "Markdown 格式，前端需渲染" },
          "owner": { "type": "number" },
          "postAt": { "type": "number" }
        },
        "required": ["title", "tags", "content", "owner", "postAt"]
      },
      "SubtaskResult": {
        "type": "object",
        "properties": {
          "type": { "type": "string", "enum": ["min", "max", "sum"] },
          "score": { "type": "number" },
          "status": { "type": "number" }
        },
        "required": ["type", "score", "status"]
      },
      "TestCase": {
        "type": "object",
        "properties": {
          "id": { "type": "number" },
          "subtaskId": { "type": "number" },
          "score": { "type": "number" },
          "time": { "type": "number" },
          "memory": { "type": "number" },
          "status": { "type": "number" },
          "message": { "type": "string" }
        },
        "required": ["time", "memory", "status", "message"]
      },
      "JudgeMessage": {
        "type": "object",
        "properties": {
          "message": { "type": "string" },
          "params": { "type": "array", "items": { "type": "string" } },
          "stack": { "type": "string" }
        },
        "required": ["message"]
      },
      "Record": {
        "type": "object",
        "properties": {
          "_id": { "type": "string", "description": "ObjectId", "title": "ID" },
          "domainId": { "type": "string", "title": "域ID" },
          "pid": { "type": "number", "title": "对应题目ID" },
          "uid": { "type": "number", "title": "提交用户ID" },
          "lang": { "type": "string", "title": "提交语言" },
          "code": { "type": "string", "title": "代码" },
          "score": { "type": "number", "title": "得分" },
          "memory": { "type": "number", "title": "使用内存（KB）" },
          "time": { "type": "number", "title": "评测用时" },
          "judgeTexts": {
            "type": "array",
            "items": { "oneOf": [{ "type": "string" }, { "$ref": "#/components/schemas/JudgeMessage" }] },
            "title": "评测信息"
          },
          "compilerTexts": { "type": "array", "items": { "type": "string" }, "title": "编译信息" },
          "testCases": { "type": "array", "items": { "$ref": "#/components/schemas/TestCase" }, "title": "测试用例" },
          "rejudged": { "type": "boolean", "title": "是否是重新评测" },
          "source": { "type": "string" },
          "judger": { "type": "number", "description": "judge uid" },
          "judgeAt": { "type": "string", "format": "date-time", "title": "评测时间" },
          "status": { "type": "number", "title": "状态码" },
          "progress": { "type": "number", "title": "进度" },
          "input": { "type": "string", "description": "pretest & hack" },
          "contest": { "type": "string", "description": "ObjectId", "title": "比赛ID" },
          "files": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "properties": {},
            "title": "文件字典"
          },
          "subtasks": {
            "type": "object",
            "properties": {},
            "title": "子任务结果",
            "additionalProperties": { "$ref": "#/components/schemas/SubtaskResult" },
            "description": "有些题目配置了子任务，这里可以查看其运行结果"
          }
        },
        "required": [
          "_id",
          "domainId",
          "pid",
          "uid",
          "lang",
          "code",
          "score",
          "memory",
          "time",
          "judgeTexts",
          "compilerTexts",
          "testCases",
          "rejudged",
          "judger",
          "judgeAt",
          "status"
        ]
      },
      "UserDict": {
        "type": "object",
        "properties": {},
        "additionalProperties": { "type": "object", "properties": {} },
        "title": "UDict"
      },
      "Contest": {
        "type": "object",
        "properties": {
          "_id": { "type": "string", "description": "ObjectID" },
          "docId": { "type": "string", "description": "ObjectID" },
          "docType": {
            "type": "integer",
            "enum": [30, 31, 32, 40],
            "format": "uint32",
            "title": "类型",
            "description": "30=比赛 32=系统题单"
          },
          "beginAt": {
            "type": "string",
            "format": "date-time",
            "title": "开始日期",
            "description": "比赛/作业的开放日期（题单不受此影响）"
          },
          "endAt": { "type": "string", "format": "date-time", "title": "结束日期" },
          "attend": { "type": "number", "title": "参加人数" },
          "title": { "type": "string", "title": "标题" },
          "content": { "type": "string", "title": "说明内容" },
          "rule": {
            "type": "string",
            "enum": ["acm", "oi", "homework", "ioi", "ledo", "strictioi"],
            "examples": ["homework"],
            "title": "规则",
            "description": "比赛规则（赛制），homework为特殊规则"
          },
          "pids": { "type": "array", "items": { "type": "number" }, "title": "题目" },
          "rated": { "type": "boolean", "title": "是否排名" },
          "_code": { "type": "string" },
          "assign": {
            "type": "array",
            "items": { "type": "string", "description": "小组名" },
            "title": "分配给",
            "description": "若只分配给特定小组，则只有特定组有权限访问（与权限组结合）"
          },
          "files": { "type": "array", "items": { "$ref": "#/components/schemas/FileInfo" } },
          "allowViewCode": { "type": "boolean" },
          "lockAt": { "type": "string", "format": "date-time", "description": "仅用于比赛", "title": "锁定日期" },
          "unlocked": { "type": "boolean", "title": "是否解封", "description": "仅用于比赛" },
          "autoHide": {
            "type": "boolean",
            "title": "自动隐藏",
            "description": "不在日期内自动隐藏，仅用于比赛（schedule实现）"
          },
          "balloon": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "properties": {},
            "description": "仅用于比赛"
          },
          "score": {
            "type": "object",
            "additionalProperties": { "type": "number" },
            "properties": {},
            "title": "参与者得分",
            "description": "仅用于比赛"
          },
          "duration": { "type": "number", "title": "比赛时长", "description": "单位为小时，仅用于比赛" }
        },
        "required": [
          "_id",
          "docId",
          "docType",
          "beginAt",
          "endAt",
          "attend",
          "title",
          "content",
          "rule",
          "pids",
          "duration"
        ]
      },
      "ContestStatus": {
        "type": "object",
        "properties": {
          "_id": { "type": "string", "title": "ObjectID" },
          "docId": { "type": "string", "description": "关联的DocID" },
          "docType": { "type": "number", "description": "关联的DocType" },
          "domainId": { "type": "string", "title": "域ID" },
          "uid": { "type": "number", "title": "用户ID" },
          "attend": { "type": "integer", "title": "是否参加", "enum": [1, 0], "default": null },
          "startAt": { "type": "string", "title": "参加时间", "format": "date-time" },
          "journal": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "rid": { "type": "string", "title": "评测记录ID" },
                "pid": { "type": "integer", "title": "题目ID" },
                "status": {
                  "type": "integer",
                  "title": "评测状态",
                  "enum": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 30, 31, 32, 33]
                },
                "score": { "type": "integer" },
                "subtasks": {
                  "type": "object",
                  "properties": {},
                  "additionalProperties": {
                    "type": "object",
                    "properties": {
                      "type": { "type": "string", "enum": ["sum", "min", "max"] },
                      "score": { "type": "integer" },
                      "status": {
                        "type": "integer",
                        "enum": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 30, 31, 32, 33]
                      }
                    },
                    "required": ["type", "score", "status"]
                  }
                }
              },
              "required": ["rid", "pid", "status", "score", "subtasks"]
            }
          },
          "score": { "type": "integer", "title": "得分" }
        },
        "required": ["journal", "score", "_id", "docId", "docType", "domainId", "uid"]
      },
      "StatusBaseDoc": {
        "type": "object",
        "properties": {
          "_id": { "type": "string", "title": "ObjectID" },
          "docId": { "type": "string", "description": "关联的DocID" },
          "docType": { "type": "number", "description": "关联的DocType" },
          "domainId": { "type": "string", "title": "域ID" },
          "uid": { "type": "number", "title": "用户ID" }
        },
        "required": ["_id", "docId", "docType", "domainId", "uid"]
      },
      "Document": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "docId": { "type": "string" },
          "docType": { "type": "integer" },
          "domainId": { "type": "string" },
          "owner": { "type": "integer" },
          "maintainer": { "type": "array", "items": { "type": "integer" } }
        },
        "required": ["_id", "docId", "docType", "domainId", "owner", "maintainer"]
      },
      "ProblemStatus": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "docId": { "type": "number" },
          "docType": { "type": "number", "const": 10 },
          "domainId": { "type": "string" },
          "uid": { "type": "number" },
          "rid": { "type": "string" },
          "score": { "type": "number" },
          "status": { "type": "number" },
          "nSubmit": { "type": "number" },
          "nAccept": { "type": "number" },
          "star": { "type": "boolean" }
        },
        "required": ["_id", "docId", "docType", "domainId", "uid"]
      },
      "Problem": {
        "type": "object",
        "properties": {
          "docType": { "type": "number", "const": 10, "title": "类型", "description": "题目docType=10" },
          "docId": { "type": "number", "description": "题目真实ID是数字" },
          "pid": { "type": "string", "title": "PID", "description": "题目外显ID可以是pid，二者都可以寻址到题目" },
          "title": { "type": "string" },
          "content": { "type": "string" },
          "nSubmit": { "type": "number" },
          "nAccept": { "type": "number" },
          "tag": { "type": "array", "items": { "type": "string" } },
          "data": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/FileInfo" },
            "description": "题目数据（如输入、输出等）",
            "title": "数据文件"
          },
          "additional_file": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/FileInfo" },
            "title": "其他文件"
          },
          "hidden": { "type": "boolean" },
          "html": { "type": "boolean", "description": "是否为HTML格式" },
          "stats": { "type": "string" },
          "difficulty": { "type": "number" },
          "sort": { "type": "string", "description": "题目用于排序的字段" },
          "reference": {
            "type": "object",
            "properties": { "domainId": { "type": "string" }, "pid": { "type": "number" } },
            "required": ["domainId", "pid"]
          },
          "assign": { "type": "array", "items": { "type": "string" } },
          "config": { "oneOf": [{ "type": "string" }, { "$ref": "#/components/schemas/ProblemConfig" }] }
        },
        "required": [
          "docType",
          "docId",
          "pid",
          "title",
          "content",
          "nSubmit",
          "nAccept",
          "tag",
          "data",
          "additional_file",
          "config"
        ]
      },
      "ProblemConfig": {
        "type": "object",
        "properties": {
          "redirect": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 2 },
          "count": { "type": "number" },
          "memoryMax": { "type": "number" },
          "memoryMin": { "type": "number" },
          "timeMax": { "type": "number" },
          "timeMin": { "type": "number" },
          "langs": { "type": "array", "items": { "type": "string" } },
          "type": { "type": "string" },
          "subType": { "type": "string" },
          "target": { "type": "string" },
          "hackable": { "type": "boolean" }
        },
        "required": ["count", "memoryMax", "memoryMin", "timeMax", "timeMin", "type"]
      },
      "SystemProblemList": {
        "type": "object",
        "properties": {
          "parent": { "type": "string", "title": "父节点", "description": "ObjectID" },
          "children": {
            "type": "array",
            "items": { "type": "string", "description": "ObjectID" },
            "title": "子节点数组"
          },
          "_id": { "type": "string", "description": "ObjectID" },
          "docId": { "type": "string", "description": "ObjectID" },
          "docType": {
            "type": "integer",
            "enum": [30, 31, 32, 40],
            "format": "uint32",
            "title": "类型",
            "description": "30=比赛 32=系统题单"
          },
          "beginAt": {
            "type": "string",
            "format": "date-time",
            "title": "开始日期",
            "description": "比赛/作业的开放日期（题单不受此影响）"
          },
          "endAt": { "type": "string", "format": "date-time", "title": "结束日期" },
          "title": { "type": "string", "title": "标题" },
          "content": { "type": "string", "title": "说明内容" },
          "rule": {
            "type": "string",
            "enum": ["acm", "oi", "homework", "ioi", "ledo", "strictioi"],
            "examples": ["homework"],
            "title": "规则",
            "description": "比赛规则（赛制），homework为特殊规则"
          },
          "pids": { "type": "array", "items": { "type": "number" }, "title": "题目" },
          "assign": {
            "type": "array",
            "items": { "type": "string", "description": "小组名" },
            "title": "分配给",
            "description": "若只分配给特定小组，则只有特定组有权限访问（与权限组结合）"
          }
        },
        "required": [
          "parent",
          "children",
          "_id",
          "docId",
          "docType",
          "beginAt",
          "endAt",
          "title",
          "content",
          "rule",
          "pids"
        ]
      },
      "FileInfo": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "name": { "type": "string" },
          "size": { "type": "number" },
          "etag": { "type": "string" },
          "lastModified": { "type": "string", "format": "date-time" }
        },
        "required": ["_id", "name", "size", "etag", "lastModified"]
      },
      "ContestBase": {
        "type": "object",
        "properties": {
          "_id": { "type": "string", "description": "ObjectID" },
          "docId": { "type": "string", "description": "ObjectID" },
          "docType": {
            "type": "integer",
            "enum": [30, 31, 32, 40],
            "format": "uint32",
            "title": "类型",
            "description": "30=比赛 32=系统题单"
          },
          "beginAt": {
            "type": "string",
            "format": "date-time",
            "title": "开始日期",
            "description": "比赛/作业的开放日期（题单不受此影响）"
          },
          "endAt": { "type": "string", "format": "date-time", "title": "结束日期" },
          "attend": { "type": "number", "title": "参加人数" },
          "title": { "type": "string", "title": "标题" },
          "content": { "type": "string", "title": "说明内容" },
          "rule": {
            "type": "string",
            "enum": ["acm", "oi", "homework", "ioi", "ledo", "strictioi"],
            "examples": ["homework"],
            "title": "规则",
            "description": "比赛规则（赛制），homework为特殊规则"
          },
          "pids": { "type": "array", "items": { "type": "number" }, "title": "题目" },
          "rated": { "type": "boolean", "title": "是否排名" },
          "_code": { "type": "string" },
          "assign": {
            "type": "array",
            "items": { "type": "string", "description": "小组名" },
            "title": "分配给",
            "description": "若只分配给特定小组，则只有特定组有权限访问（与权限组结合）"
          },
          "files": { "type": "array", "items": { "$ref": "#/components/schemas/FileInfo" } },
          "allowViewCode": { "type": "boolean" },
          "lockAt": { "type": "string", "format": "date-time", "description": "仅用于比赛", "title": "锁定日期" },
          "unlocked": { "type": "boolean", "title": "是否解封", "description": "仅用于比赛" },
          "autoHide": {
            "type": "boolean",
            "title": "自动隐藏",
            "description": "不在日期内自动隐藏，仅用于比赛（schedule实现）"
          },
          "balloon": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "properties": {},
            "description": "仅用于比赛"
          },
          "score": {
            "type": "object",
            "additionalProperties": { "type": "number" },
            "properties": {},
            "title": "参与者得分",
            "description": "仅用于比赛"
          },
          "duration": { "type": "number", "title": "比赛时长", "description": "单位为小时，仅用于比赛" },
          "penaltySince": {
            "type": "string",
            "format": "date-time",
            "title": "惩罚起始时间",
            "description": "仅用于作业"
          },
          "penaltyRules": { "title": "惩罚规则", "description": "仅用于作业", "type": "object", "properties": {} }
        },
        "required": [
          "docId",
          "docType",
          "beginAt",
          "endAt",
          "attend",
          "title",
          "content",
          "rule",
          "pids",
          "duration",
          "_id"
        ]
      },
      "Error": {
        "type": "object",
        "properties": {
          "message": { "type": "string", "title": "错误信息" },
          "params": {
            "type": "array",
            "items": { "type": "string" },
            "title": "参数",
            "description": "错误参数，一般可以填入错误信息中的模板插值占位符"
          },
          "stack": { "type": "string", "title": "错误堆栈", "description": "服务端的错误堆栈信息" }
        },
        "required": ["message", "params", "stack"]
      },
      "Group": {
        "properties": {
          "_id": { "type": "string" },
          "domainId": { "type": "string" },
          "name": { "type": "string" },
          "uids": { "type": "array", "items": { "type": "integer" } },
          "parent": { "type": "string", "title": "父节点", "description": "父节点的ObjectId", "nullable": true },
          "children": {
            "type": "array",
            "items": { "type": "string", "description": "子节点的ObjectId" },
            "nullable": true
          },
          "activation": { "type": "array", "items": { "type": "string" } }
        },
        "type": "object",
        "required": ["_id", "domainId", "name", "uids"]
      },
      "ActivationToken": {
        "properties": {
          "_id": { "type": "string" },
          "updateIp": { "type": "string" },
          "updateUa": { "type": "string" },
          "createIp": { "type": "string" },
          "createUa": { "type": "string" },
          "createHost": { "type": "string" },
          "tokenType": { "type": "integer", "description": "枚举类型，激活码Type=10" },
          "createAt": { "type": "string", "description": "日期ISO String" },
          "updateAt": { "type": "string", "description": "日期ISO String" },
          "expireAt": { "type": "string", "description": "日期ISO String" }
        },
        "type": "object",
        "required": ["_id", "tokenType", "createAt", "expireAt"]
      },
      "User": {
        "properties": {
          "_id": { "type": "integer" },
          "mail": { "type": "string" },
          "mailLower": { "type": "string" },
          "uname": { "type": "string" },
          "unameLower": { "type": "string" },
          "hash": { "type": "string" },
          "salt": { "type": "string" },
          "hashType": { "type": "string" },
          "regat": { "type": "string" },
          "ip": { "type": "array", "items": { "type": "string" } },
          "loginat": { "type": "string" },
          "loginip": { "type": "string" },
          "priv": { "type": "integer" },
          "avatar": { "type": "string" },
          "nationality": { "type": "string" },
          "age": { "type": "integer" },
          "oier": { "type": "boolean" },
          "nickname": { "type": "string" }
        },
        "type": "object"
      },
      "Domain": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "name": { "type": "string" },
          "lower": { "type": "string", "description": "域名称的小写版" },
          "owner": { "type": "integer", "description": "UID" },
          "bulletin": { "type": "string", "description": "系统公告" },
          "roles": {
            "type": "object",
            "properties": {
              "guest": { "type": "string", "description": "访客权限" },
              "default": { "type": "string", "description": "登录用户权限" }
            },
            "additionalProperties": { "type": "string" },
            "description": "域内权限组定义"
          },
          "avatar": { "type": "string", "description": "域头像URL" },
          "langs": { "type": "string", "description": "允许的编程语言（逗号分隔）" },
          "share": { "type": "string" }
        },
        "additionalProperties": true
      },
      "UiContext": {
        "type": "object",
        "properties": {
          "cdn_prefix": { "type": "string", "description": "系统设置中定义，请求静态资源时前缀" },
          "url_prefix": { "type": "string", "description": "系统设置中定义，服务器URL前缀" },
          "ws_prefix": { "type": "string", "description": "系统设置中定义，web socket前缀" },
          "domainId": { "type": "string" },
          "domain": { "$ref": "#/components/schemas/Domain" }
        },
        "required": ["url_prefix", "ws_prefix", "cdn_prefix", "domainId", "domain"]
      },
      "UserContext": {
        "type": "object",
        "properties": {
          "authn": { "type": "boolean" },
          "uname": { "type": "string" },
          "mail": { "type": "string" },
          "gender": { "type": "string" },
          "avatar": { "type": "string" },
          "avatarUrl": { "type": "string" },
          "backgroundImage": { "type": "string" },
          "loginat": { "type": "string" },
          "regat": { "type": "string" },
          "fontFamily": { "type": "string" },
          "theme": { "type": "string" },
          "timeZone": { "type": "string" },
          "codeLang": { "type": "string" },
          "codeFontFamily": { "type": "string" },
          "formatCode": { "type": "boolean" },
          "monacoTheme": { "type": "string" },
          "preferredEditorType": { "type": "string" },
          "hashType": { "type": "string" },
          "tfa": { "type": "boolean" },
          "groups": { "type": "array", "items": { "type": "string" } },
          "perm": { "type": "string" },
          "priv": { "type": "integer" },
          "role": { "type": "string" },
          "rpInfo": {
            "type": "object",
            "properties": { "key1": { "type": "string" }, "key2": { "type": "string" } },
            "required": ["key1", "key2"]
          },
          "scope": { "type": "string" },
          "domains": { "type": "array", "items": { "type": "string" } },
          "pinnedDomains": { "type": "array", "items": { "type": "string" } },
          "id": { "type": "string" }
        },
        "required": [
          "authn",
          "id",
          "uname",
          "mail",
          "gender",
          "avatar",
          "avatarUrl",
          "backgroundImage",
          "loginat",
          "regat",
          "fontFamily",
          "theme",
          "timeZone",
          "codeLang",
          "codeFontFamily",
          "formatCode",
          "monacoTheme",
          "preferredEditorType",
          "hashType",
          "tfa",
          "groups",
          "perm",
          "priv",
          "role",
          "rpInfo",
          "scope",
          "domains",
          "pinnedDomains"
        ]
      }
    },
    "securitySchemes": {}
  },
  "servers": []
}
